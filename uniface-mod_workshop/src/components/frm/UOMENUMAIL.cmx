<?xml version='1.0' encoding='UTF-8' ?>
<!-- Created by UNIFACE - (C) Compuware Corporation -->
<!DOCTYPE UNIFACE PUBLIC "UNIFACE.DTD" "UNIFACE.DTD">
<UNIFACE release="9.6" xmlengine="2.0">
<TABLE>
<DSC name="UFORM" model="DICT" system="S" pseudo ="73" level="1" noupdate="0"
 rbk="0" ffsql="0" transnr="0" segsize="0" ufocc="1000" charset=".U">
<FLD name="UTIMESTAMP" seqno="1" type="E" level="2" pack="0" scale="0" length="15"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UCOMPSTAMP" seqno="2" type="E" level="2" pack="0" scale="0" length="15"
 pointer="0" inum="0" ufocc="0" />
<FLD name="ULABEL" seqno="3" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="1" ufocc="0" mandatory="yes" idxnum="1" idxsnr="101" />
<FLD name="FTYP" seqno="4" type="S" level="2" pack="0" scale="0" length="4"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UVERS" seqno="5" type="S" level="2" pack="0" scale="0" length="12"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UDESCR" seqno="6" type="S" level="2" pack="0" scale="0" length="25"
 pointer="0" inum="0" ufocc="0" />
<FLD name="FHEAD" seqno="7" type="S" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="VMAAT" seqno="8" type="S" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="HMAAT" seqno="9" type="S" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UCOLOR" seqno="10" type="S" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="WVPOS" seqno="11" type="S" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="WHPOS" seqno="12" type="S" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="WVSIZ" seqno="13" type="S" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="WHSIZ" seqno="14" type="S" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="CLRSCRN" seqno="15" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UBORDER" seqno="16" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="RIBIN" seqno="17" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="0" ufocc="0" />
<FLD name="RIBOT" seqno="18" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="0" ufocc="0" />
<FLD name="MOVABLE" seqno="19" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="VIDEOINVERSE" seqno="20" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="VIDEOBRIGHT" seqno="21" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="VIDEOUNLINE" seqno="22" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="VIDEOBLINK" seqno="23" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UPANEL" seqno="24" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="0" ufocc="0" />
<FLD name="POSPANEL" seqno="25" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UPULL" seqno="26" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="0" ufocc="0" />
<FLD name="HIDESTACK" seqno="27" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TEMPLATENAME" seqno="28" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="1" ufocc="0" idxnum="2" idxsnr="1" />
<FLD name="UINHERIT" seqno="29" type="B" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="LIBRAR" seqno="30" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UTRANSACT" seqno="31" type="S" level="2" pack="0" scale="0" length="8"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TPLACTUAL" seqno="32" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D3,0,0,0,,0,0,0,," />
<FLD name="CONSTRAINTS" seqno="33" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D4,0,0,0,,0,0,0,," />
<FLD name="INIT" seqno="34" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C1,0,0,0,,0,0,0,," />
<FLD name="CLEAR" seqno="35" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C2,0,0,0,,0,0,0,," />
<FLD name="RETRIEVE" seqno="36" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C3,0,0,0,,0,0,0,," />
<FLD name="RECORD" seqno="37" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C4,0,0,0,,0,0,0,," />
<FLD name="STORE" seqno="38" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C5,0,0,0,,0,0,0,," />
<FLD name="DELET" seqno="39" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C6,0,0,0,,0,0,0,," />
<FLD name="ACCEPT" seqno="40" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C7,0,0,0,,0,0,0,," />
<FLD name="QUIT" seqno="41" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C8,0,0,0,,0,0,0,," />
<FLD name="MENU" seqno="42" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C9,0,0,0,,0,0,0,," />
<FLD name="INTKEY" seqno="43" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CA,0,0,0,,0,0,0,," />
<FLD name="SPRINT" seqno="44" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CB,0,0,0,,0,0,0,," />
<FLD name="EPRINT" seqno="45" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CC,0,0,0,,0,0,0,," />
<FLD name="ASYNC" seqno="46" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CD,0,0,0,,0,0,0,," />
<FLD name="GENERAL" seqno="47" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CE,0,0,0,,0,0,0,," />
<FLD name="FORMPIC" seqno="48" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E0,0,0,0,,0,0,0,," />
<FLD name="HEADER" seqno="49" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E3,0,0,0,,0,0,0,," />
<FLD name="LISTING" seqno="50" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E5,0,0,0,,0,0,0,," />
<FLD name="PERF" seqno="51" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E1,0,0,0,,0,0,0,," />
<FLD name="PROTO" seqno="52" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E2,0,0,0,,0,0,0,," />
<FLD name="TITLE" seqno="53" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E7,0,0,0,,0,0,0,," />
<FLD name="WINPROP" seqno="54" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D2,0,0,0,,0,0,0,," />
<FLD name="FRLF" seqno="55" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E4,0,0,0,,0,0,0,," />
<FLD name="FRGF" seqno="56" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E6,0,0,0,,0,0,0,," />
<FLD name="SFUNC" seqno="57" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DC,0,0,0,,0,0,0,," />
<FLD name="HTMLPROP" seqno="58" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DD,0,0,0,,0,0,0,," />
<FLD name="USCONTAINED" seqno="59" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CF,0,0,0,,0,0,0,," />
<FLD name="UEXECDEF" seqno="60" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D0,0,0,0,,0,0,0,," />
<FLD name="UPOPUP" seqno="61" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D5,0,0,0,,0,0,0,," />
<FLD name="UML_DATA" seqno="62" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D6,0,0,0,,0,0,0,," />
<FLD name="HTML_CMPPROP" seqno="63" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D1,0,0,0,,0,0,0,," />
<FLD name="HTML_FORMAT" seqno="64" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D7,0,0,0,,0,0,0,," />
<FLD name="HTML_STYLES" seqno="65" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D8,0,0,0,,0,0,0,," />
<FLD name="HTML_HOOK_H" seqno="66" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D9,0,0,0,,0,0,0,," />
<FLD name="HTML_HOOK_B" seqno="67" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DA,0,0,0,,0,0,0,," />
<FLD name="HTML_HOOK_E" seqno="68" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DB,0,0,0,,0,0,0,," />
<FLD name="HTML_BODYHOOK" seqno="69" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DE,0,0,0,,0,0,0,," />
<FLD name="HTML_CMPCLASS" seqno="70" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DF,0,0,0,,0,0,0,," />
<FLD name="GETSTATE" seqno="71" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E8,0,0,0,,0,0,0,," />
<FLD name="SETSTATE" seqno="72" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E9,0,0,0,,0,0,0,," />
<FLD name="UNOSTATE" seqno="73" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EA,0,0,0,,0,0,0,," />
<FLD name="CMP_EXT" seqno="74" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EB,0,0,0,,0,0,0,," />
<FLD name="UCTRIGGERS" seqno="75" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EC,0,0,0,,0,0,0,," />
<FLD name="UACCESSPATH" seqno="76" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\ED,0,0,0,,0,0,0,," />
<FLD name="USPLITPROP" seqno="77" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EE,0,0,0,,0,0,0,," />
<FLD name="TPLACTUAL2" seqno="78" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EF,0,0,0,,0,0,0,," />
<FLD name="USTATEMANAGEDBY" seqno="79" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\F0,0,0,0,,0,0,0,," />
<FLD name="HTMLSKELETON" seqno="80" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\F1,0,0,0,,0,0,0,," />
</DSC>
<OCC>
<DAT name="UTIMESTAMP">2012-05-11T12:59:50.00</DAT>
<DAT name="UCOMPSTAMP">2015-08-18T15:07:51.00</DAT>
<DAT name="ULABEL">UOMENUMAIL</DAT>
<DAT name="FTYP">S</DAT>
<DAT name="WVPOS">3</DAT>
<DAT name="WHPOS">17</DAT>
<DAT name="WVSIZ">47</DAT>
<DAT name="WHSIZ">178</DAT>
<DAT name="CLRSCRN">N</DAT>
<DAT name="UBORDER">N</DAT>
<DAT name="MOVABLE">Y</DAT>
<DAT name="HIDESTACK">N</DAT>
<DAT name="UINHERIT">F</DAT>
<DAT name="UTRANSACT">0</DAT>
<DAT name="TPLACTUAL" xml:space='preserve'>
#Comment ----------------------------------------------
#Comment start_of_references
#ifdefined TEMPLATENAME
#info symbol TEMPLATENAME is already or also defined as a global or local constant
#endif
#define TEMPLATENAME=
#Comment 

#Comment end_of_references


#Comment ----------------------------------------------
#Comment start_of_mappings
#Comment end_of_mappings


#Comment ----------------------------------------------
#Comment start_of_symbols
#Comment end_of_symbols


#Comment ----------------------------------------------
</DAT>
<DAT name="INIT" xml:space='preserve'>;Params
;   String  pvUOID    : IN
;   Numeric pvConCode : IN
;EndParams

Variables
   String lvTreeValRep
EndVariables

;$CV_UOUTLOOKID$ = pvUOID
;call GP_WINPOS($instancename)
;ALLMAILTREE.DUMMY = "INBOX"
;$CV_CONCODE$ = pvConCode
;if ($CV_CONCODE$ = 1)
;   $instancename-&gt;opStartTimer()
;   $instancename-&gt;opSendRecMail()
;else
;   postmessage "UOMAINMAILLIST", "OLDMAIL", ""
;endif

lvTreeValRep = $valrep(ALLMAILTREE.DUMMY)
activate/stateless "UOLOCMAIL".GetOutBoxCount($CV_OUTBOX_NUM$)
if ($CV_OUTBOX_NUM$ &gt; 0)
   call lpUpdateTree(lvTreeValRep, "Outbox", "Outbox (%%$CV_OUTBOX_NUM$%%%)")
   $valrep(ALLMAILTREE.DUMMY) = lvTreeValRep
endif
display</DAT>
<DAT name="ACCEPT">;return(-1)</DAT>
<DAT name="QUIT">;return(-1)</DAT>
<DAT name="ASYNC" xml:space='preserve'>Variables
   String lvTreeValRep
   String lvCurTreeVal
   String lvOldText
   String lvNewText
EndVariables

lvCurTreeVal = ALLMAILTREE.DUMMY
lvTreeValRep = $valrep(ALLMAILTREE.DUMMY)

if ($msgid = "TIMER")
   $instancehandle-&gt;opSendRecMail()
endif

if ($msgid = "OUTBOX_UPDATE")
   if ($CV_OUTBOX_NUM$ &gt; 0)
      lvOldText       = "Outbox (%%$CV_OUTBOX_NUM$%%%)"
   else
      lvOldText       = "Outbox"
   endif
   $CV_OUTBOX_NUM$ = ($CV_OUTBOX_NUM$ + 1)
   lvNewText       = "Outbox (%%$CV_OUTBOX_NUM$%%%)"
   call lpUpdateTree(lvTreeValRep, lvOldText, lvNewText)
   $valrep(ALLMAILTREE.DUMMY) = lvTreeValRep
   ALLMAILTREE.DUMMY = lvCurTreeVal
endif

if ($msgid = "KILL")
   $CV_TIMERHANDLE$-&gt;STOP()
   deleteinstance $CV_TIMERHANDLE$
   apexit
endif</DAT>
<DAT name="GENERAL" xml:space='preserve'>entry lpUpdateTree

params
   string  pio_string_in   : INOUT
   string  pi_old_text     : IN
   string  pi_new_text     : IN
endparams
variables
   string  lv_input_area, lv_hold, lv_output_area
   numeric lv_old_text_len
endvariables

lv_input_area = pio_string_in              ; move to work area
length pi_old_text
lv_old_text_len = $result                  ; store length of old text

while (lv_input_area != "")                ; repeat until empty
   scan lv_input_area, pi_old_text         ; look for old_text
   if ($result &lt; 1)                    ; not found
       lv_hold = lv_input_area             ; use whole string
       lv_input_area = ""                  ; nothing left
   else                                ; found
       $result = $result -1                ; backspace over old text
       lv_hold = lv_input_area[1:$result]  ; extract pre-old text
       lv_hold = "%%lv_hold%%pi_new_text"  ; append new text
       $result = $result + lv_old_text_len ; add length of old text
       $result = $result +1                ; skip over old text
       lv_input_area = lv_input_area[$result]  ; drop pre-old text
   endif
   lv_output_area = "%%lv_output_area%%lv_hold"
endwhile

pio_string_in = lv_output_area             ; replace with adjusted string

return(0)

end ; entry lpUpdateTree</DAT>
<DAT name="FORMPIC" xml:space='preserve'>&uFRM;TYP=E&uSEP;NAM=DUMMY.DUMMY&uSEP;WID=30&uSEP;HEI=21&uSEP;HOC=30&uSEP;VOC=21&uSEP;BAR=N&uFRM;&uFRM;TYP=F&uSEP;NAM=MTITLE&uSEP;WID=30&uSEP;HEI=2&uSEP;COL=32&uFRM;

&uFRM;TYP=F&uSEP;NAM=FAVFOLTITLE&uSEP;WID=30&uSEP;HEI=1&uFRM;
&uFRM;TYP=F&uSEP;NAM=FAVFOLTREE&uSEP;WID=30&uSEP;HEI=6&uFRM;





&uFRM;TYP=F&uSEP;NAM=ALLMAILFOLTITLE&uSEP;WID=30&uSEP;HEI=1&uFRM;
&uFRM;TYP=F&uSEP;NAM=ALLMAILTREE&uSEP;WID=30&uSEP;HEI=10&uFRM;









&uFRM;TYP=E&uSEP;NAM=LOCALMAILSFRM.UO&uSEP;WID=11&uSEP;HEI=1&uSEP;HOC=11&uSEP;VOC=1&uSEP;BAR=N&uFRM;</DAT>
<DAT name="WINPROP" xml:space='preserve'>CAPTION=F&uSEP;CANRESIZE=F&uSEP;CANICONIZE=F&uSEP;CANZOOM=F&uSEP;CANCLOSE=F&uSEP;SYSMENU=F&uSEP;IMAGE=&uSEP;MODAL=F&uSEP;ATTACHED=&uSEP;UTYPE=&uSEP;DIRECTION=&uSEP;SPLIT=(30,48,v,r,n,f,(30,20,h,b,n,f,p,p),p)&uSEP;NOFORMSCROLL=T</DAT>
<DAT name="SFUNC" xml:space='preserve'>operation opStartTimer

   ;===== Timer part needs to be made configurable. Temp solution for the refresh rate until Mail Preferences exisit in the DB=========
   newinstance "UTIMER", $CV_TIMERHANDLE$
   $CV_TIMERHANDLE$-&gt;SETREPEAT(0)
   $CV_TIMERHANDLE$-&gt;SETMESSAGE("UOMENUMAIL", "TIMER", "")
   $CV_TIMERHANDLE$-&gt;START("00:01:00")
   ;========= End of Timer part ============

   return(0)

end ; operation opStartTimer

;=====================================================================================
;=====================================================================================
operation opSendRecMail

   Variables
      String  lvMailHeader
      String  lvMailText
      Numeric lvErrorCode
      String  lvErrorText
   EndVariables

   lvMailHeader  = ""
   lvMailText    = ""

;+++ Get all required POP3 Server details (ONLY if first time)....
   if ($CV_POP3$ = "" | $CV_SMTP$ = "" | $CV_USER$ = "" | $CV_PWD$ = "" | $CV_EMAIL$ = "")
      lvErrorCode = 0
      lvErrorCode = ""
      activate/sync "UOLOCMAIL".GetAllDetails($CV_UOUTLOOKID$, $CV_POP3$, $CV_SMTP$, $CV_USER$, $CV_PWD$, $CV_EMAIL$, lvErrorCode, lvErrorText)
      if (lvErrorCode &lt; 0)
         message/nobeep "Unable to get details ..."
         return(0)
      endif
   endif

   $instancename-&gt;opSendMail()
   $instancename-&gt;opReceiveMail()

   return(0)

end ; operation opSendRecMail

;====================================================================================================
;====================================================================================================
operation opSendMail

   Variables
      Numeric lvErrorCode
      String  lvErrorText
      String  lvMailHeader
      String  lvMailText
      String  lvTO
      String  lvFROM
      String  lvCC
      String  lvBCC
      String  lvSUBJECT
      String  lvPRIORITY
      String  lvREPLY
      String  lvXMLData
      String  lvTreeValRep
      String  lvOldText
      String  lvNewText
      String  lvCurTreeVal
   EndVariables

;+++ Connect to Mail Servers and connection ...
;;+++ Log on to POP3 Server ...

   activate "UPOPMail".LogonMail("%%$CV_POP3$%%%", "%%$CV_USER$%%%", "%%$CV_PWD$%%%")
   if ($status &lt; 0)
      message/nobeep "Unable to establish connection with POP3 Server ...%%$status"
      return(0)
   endif

;+++ LogOn to SMTP server...
   activate "UPOPMail".LogonSMTP("%%$CV_SMTP$%%%", "", "")
   if ($status &lt; 0)
      message/nobeep "Unable to establish connection with SMTP Server ...."
      activate "UPOPMail".LogoffMail() ;+++ Disconnect from POP3 Server first ....
      return(0)
   endif

;+++ Get Mail records from Outbox ....
   lvErrorCode = 0
   lvErrorCode = ""

   clear/e "LOCALMAILSFRM.UO"
   LM_MAID.LOCALMAILSFRM   = "1"
   LM_FOLDER.LOCALMAILSFRM = "OUTBOX"
   xmlsave lvXMLData, "DTD:&lt;myDtd&gt;", "&lt;myDtdMapping&gt;"
   activate/stateless "UOLOCMAIL".GetMailBox(lvXMLData, lvErrorCode, lvErrorText)
   if (lvErrorCode &lt; 0)
      activate "UPOPMail".LogoffSMTP() ;+++ Disconnect from POP3 Server first ....
      activate "UPOPMail".LogoffMail() ;+++ Disconnect from POP3 Server too ....
      return(0)
   endif

;+++ Load XML data ...
   clear/e "LOCALMAILSFRM.UO"
   xmlload lvXMLData, "DTD:&lt;myDtd&gt;", "&lt;myDtdMapping&gt;"
   retrieve/reconnect "LOCALMAILSFRM.UO"

;+++ If there is new mail to be sent ...
   setocc "LOCALMAILSFRM.UO", 1
   while ($status &gt; -1 &amp; LM_ID.LOCALMAILSFRM.UO != "")
      getitem/id lvTO, LM_MAIL.LOCALMAILSFRM, "TO"
      getitem/id lvFROM, LM_MAIL.LOCALMAILSFRM, "FROM"
      getitem/id lvCC, LM_MAIL.LOCALMAILSFRM, "CC"
      getitem/id lvBCC, LM_MAIL.LOCALMAILSFRM, "BCC"
      getitem/id lvSUBJECT, LM_MAIL.LOCALMAILSFRM, "SUBJECT"
      getitem/id lvPRIORITY, LM_MAIL.LOCALMAILSFRM, "PRIORITY"
      getitem/id lvREPLY, LM_MAIL.LOCALMAILSFRM, "REPLY"
      lvMailHeader = "TO=%%lvTO%%%&uSEP;FROM=%%lvFROM%%%&uSEP;CC=%%lvCC%%%&uSEP;BCC=%%lvBCC%%%&uSEP;SUBJECT=%%lvSUBJECT%%%&uSEP;PRIORITY=%%lvPRIORITY%%%&uSEP;REPLY=%%lvREPLY%%%"
      getitem/id lvMailText, LM_MAIL.LOCALMAILSFRM, "MSGTEXT"
      activate "UPOPMail".SendMail("", lvMailHeader, lvMailText, LM_ATTLIST.LOCALMAILSFRM, LM_MAILSIZE.LOCALMAILSFRM)
      if ($status &lt; 0)
         message/nobeep "SendMail failure %%$status ..."    
      endif ; Try the rest anyway ...
      setocc "LOCALMAILSFRM.UO",($curocc(LOCALMAILSFRM.UO) + 1)
   endwhile

;+++ Update OUTBOX records to Sent Items ...This should be done better since there is no proof that the record has been sent for sure ... Temp solution
   if ($totocc(LOCALMAILSFRM.UO) &gt; 0)
      lvErrorCode = 0
      lvErrorCode = ""
      activate/stateless "UOLOCMAIL".SetOut2Sent(lvXMLData, lvErrorCode, lvErrorText)
      if (lvErrorCode &lt; 0)
         message/nobeep "Error while updating Outbox to Sent Items ..."
      endif      
   endif

;+++ Logoff from the SMTP Server ...
   activate "UPOPMail".LogoffSMTP()
   if ($status &lt; 0)
      message/nobeep "LogOff from SMTP Server failed %%$status..."
   endif

;+++ LogOff from POP3 server...
   activate "UPOPMail".LogoffMail()
   if ($status &lt; 0)
      message/nobeep "LogOff from POP3 Server failed %%$status..."
   endif

;+++ Update Outbox count ...
   if ($CV_OUTBOX_NUM$ &gt; 0)
      lvCurTreeVal    = ALLMAILTREE.DUMMY
      lvTreeValRep    = $valrep(ALLMAILTREE.DUMMY)
      lvOldText       = "Outbox (%%$CV_OUTBOX_NUM$%%%)"
      lvNewText       = "Outbox"
      $CV_OUTBOX_NUM$ = 0
      call lpUpdateTree(lvTreeValRep, lvOldText, lvNewText)
      $valrep(ALLMAILTREE.DUMMY) = lvTreeValRep
      ALLMAILTREE.DUMMY          = lvCurTreeVal
   endif

   return(0)

end ; operation opSendMail

;====================================================================================================
;====================================================================================================
operation opReceiveMail

   postmessage "UOMAINMAILLIST", "NEWMAIL", "%%$CV_POP3$%%%"
   return(0)

end ; operation opReceiveMail


</DAT>
<DAT name="TPLACTUAL2" xml:space='preserve'>#comment 'Create structure from DTD' generated the following constants for Three Tier applications:
#define  myDtd = LOCALMAILSDTD.UO
#define  myDtdMapping = LOCALMAILSSVC.UO=LOCALMAILSFRM.UO&uSEP;LM_ID.LOCALMAILSSVC.UO=LM_ID.LOCALMAILSFRM.UO&uSEP;LM_MAID.LOCALMAILSSVC.UO=LM_MAID.LOCALMAILSFRM.UO&uSEP;LM_FOLDER.LOCALMAILSSVC.UO=LM_FOLDER.LOCALMAILSFRM.UO&uSEP;LM_ATTLIST.LOCALMAILSSVC.UO=LM_ATTLIST.LOCALMAILSFRM.UO&uSEP;LM_MAILSIZE.LOCALMAILSSVC.UO=LM_MAILSIZE.LOCALMAILSFRM.UO&uSEP;LM_MAIL.LOCALMAILSSVC.UO=LM_MAIL.LOCALMAILSFRM.UO</DAT>
</OCC>
</TABLE>
<TABLE>
<DSC name="UXGROUP" model="DICT" system="S" pseudo ="73" level="1" noupdate="0"
 rbk="0" ffsql="0" transnr="0" segsize="0" ufocc="1000" charset=".U">
<FLD name="UTIMESTAMP" seqno="1" type="E" level="2" pack="0" scale="0" length="15"
 pointer="0" inum="0" ufocc="0" />
<FLD name="ULABEL" seqno="2" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="1" ufocc="0" mandatory="yes" idxnum="1" idxsnr="101" />
<FLD name="UBASE" seqno="3" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="1" ufocc="0" mandatory="yes" idxnum="1" idxsnr="102" />
<FLD name="UFORM" seqno="4" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="2" ufocc="0" mandatory="yes" idxnum="1,2" idxsnr="103,1" />
<FLD name="UVERS" seqno="5" type="S" level="2" pack="0" scale="0" length="12"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UDESCR" seqno="6" type="S" level="2" pack="0" scale="0" length="25"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_BORD" seqno="7" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_INDB" seqno="8" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_DBMS" seqno="9" type="S" level="2" pack="0" scale="0" length="3"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_UPD" seqno="10" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_MINL" seqno="11" type="N" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_MAXL" seqno="12" type="N" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_MINR" seqno="13" type="N" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_MAXR" seqno="14" type="N" level="2" pack="0" scale="0" length="6"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TPLGINTF" seqno="15" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_INTF" seqno="16" type="S" level="2" pack="0" scale="0" length="64"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TEMPLATENAME" seqno="17" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UINHERIT" seqno="18" type="B" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TPLACTUAL" seqno="19" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E6,0,0,0,,0,0,0,," />
<FLD name="GETOCC" seqno="20" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C1,0,0,0,,0,0,0,," />
<FLD name="PUTOCC" seqno="21" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C2,0,0,0,,0,0,0,," />
<FLD name="DELOCC" seqno="22" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C3,0,0,0,,0,0,0,," />
<FLD name="LCK" seqno="23" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C4,0,0,0,,0,0,0,," />
<FLD name="UNLOCK" seqno="24" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C5,0,0,0,,0,0,0,," />
<FLD name="GETSEGM" seqno="25" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C6,0,0,0,,0,0,0,," />
<FLD name="ADDOCC" seqno="26" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C7,0,0,0,,0,0,0,," />
<FLD name="DELOCCR" seqno="27" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C8,0,0,0,,0,0,0,," />
<FLD name="ENDMOD" seqno="28" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C9,0,0,0,,0,0,0,," />
<FLD name="DOC" seqno="29" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CA,0,0,0,,0,0,0,," />
<FLD name="DETAIL" seqno="30" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CB,0,0,0,,0,0,0,," />
<FLD name="CREOCC" seqno="31" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CC,0,0,0,,0,0,0,," />
<FLD name="MENU" seqno="32" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CD,0,0,0,,0,0,0,," />
<FLD name="FINDOCC" seqno="33" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CE,0,0,0,,0,0,0,," />
<FLD name="ERROR" seqno="34" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CF,0,0,0,,0,0,0,," />
<FLD name="GENERAL" seqno="35" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D0,0,0,0,,0,0,0,," />
<FLD name="STARTMOD" seqno="36" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D1,0,0,0,,0,0,0,," />
<FLD name="FLIST" seqno="37" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E1,0,0,0,,0,0,0,," />
<FLD name="BREAK" seqno="38" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E2,0,0,0,,0,0,0,," />
<FLD name="VLDE" seqno="39" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D2,0,0,0,,0,0,0,," />
<FLD name="VLDK" seqno="40" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D3,0,0,0,,0,0,0,," />
<FLD name="UPOPUP" seqno="41" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D4,0,0,0,,0,0,0,," />
<FLD name="UISBCLASS" seqno="42" type="B" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UISASSOC" seqno="43" type="B" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_OBJSVC" seqno="44" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DC,0,0,0,,0,0,0,," />
<FLD name="U_SVCUSE" seqno="45" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DD,0,0,0,,0,0,0,," />
<FLD name="HTML_ENTPROP" seqno="46" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D7,0,0,0,,0,0,0,," />
<FLD name="HTML_TABTYPE" seqno="47" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D8,0,0,0,,0,0,0,," />
<FLD name="HTML_ENTHK_B" seqno="48" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D9,0,0,0,,0,0,0,," />
<FLD name="HTML_ENTHK_E" seqno="49" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DA,0,0,0,,0,0,0,," />
<FLD name="HTML_OCCHK_B" seqno="50" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DB,0,0,0,,0,0,0,," />
<FLD name="HTML_OCCHK_E" seqno="51" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DE,0,0,0,,0,0,0,," />
<FLD name="HTML_ENTCLASS" seqno="52" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DF,0,0,0,,0,0,0,," />
<FLD name="U_GLAB" seqno="53" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E0,0,0,0,,0,0,0,," />
<FLD name="UEOINTERFACE" seqno="54" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E3,0,0,0,,0,0,0,," />
<FLD name="UECINTERFACE" seqno="55" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E4,0,0,0,,0,0,0,," />
<FLD name="UEOOPERS" seqno="56" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E5,0,0,0,,0,0,0,," />
<FLD name="UECOPERS" seqno="57" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E7,0,0,0,,0,0,0,," />
<FLD name="UEOTRIGGERS" seqno="58" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E8,0,0,0,,0,0,0,," />
<FLD name="UECTRIGGERS" seqno="59" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E9,0,0,0,,0,0,0,," />
<FLD name="UGEOMETRY" seqno="60" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EA,0,0,0,,0,0,0,," />
<FLD name="UWIDGETTYPE" seqno="61" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EB,0,0,0,,0,0,0,," />
<FLD name="UWIDGETCREATE" seqno="62" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EC,0,0,0,,0,0,0,," />
<FLD name="PRLO" seqno="63" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\ED,0,0,0,,0,0,0,," />
<FLD name="PSLO" seqno="64" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EE,0,0,0,,0,0,0,," />
<FLD name="PRSO" seqno="65" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\EF,0,0,0,,0,0,0,," />
<FLD name="PSSO" seqno="66" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\F0,0,0,0,,0,0,0,," />
<FLD name="UPARENT" seqno="67" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\F1,0,0,0,,0,0,0,," />
<FLD name="UWEBWIDGETTYPE" seqno="68" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\F2,0,0,0,,0,0,0,," />
<FLD name="UWEBWIDGETCREATE" seqno="69" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\F3,0,0,0,,0,0,0,," />
</DSC>
<OCC>
<DAT name="UTIMESTAMP">2011-11-23T12:37:25.00</DAT>
<DAT name="ULABEL">DUMMY</DAT>
<DAT name="UBASE">DUMMY</DAT>
<DAT name="UFORM">UOMENUMAIL</DAT>
<DAT name="U_BORD">N</DAT>
<DAT name="U_INDB">N</DAT>
<DAT name="UINHERIT">F</DAT>
<DAT name="UISBCLASS">F</DAT>
<DAT name="UISASSOC">F</DAT>
<DAT name="HTML_ENTPROP" xml:space='preserve'>U_ATLEASTONE=1&uSEP;U_STARTOCC=1&uSEP;U_MAXOCC=</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-08T14:23:01.00</DAT>
<DAT name="ULABEL">LOCALMAILSFRM</DAT>
<DAT name="UBASE">UO</DAT>
<DAT name="UFORM">UOMENUMAIL</DAT>
<DAT name="U_DBMS">XXX</DAT>
<DAT name="UINHERIT">F</DAT>
<DAT name="FLIST">*</DAT>
<DAT name="UISBCLASS">F</DAT>
<DAT name="UISASSOC">F</DAT>
</OCC>
</TABLE>
<TABLE>
<DSC name="UXFIELD" model="DICT" system="S" pseudo ="73" level="1" noupdate="0"
 rbk="0" ffsql="0" transnr="0" segsize="0" ufocc="1000" charset=".U">
<FLD name="UTIMESTAMP" seqno="1" type="E" level="2" pack="0" scale="0" length="15"
 pointer="0" inum="0" ufocc="0" />
<FLD name="ULABEL" seqno="2" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="1" ufocc="0" mandatory="yes" idxnum="1" idxsnr="101" />
<FLD name="GRP" seqno="3" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="2" ufocc="0" mandatory="yes" idxnum="1,2" idxsnr="102,1" />
<FLD name="UBASE" seqno="4" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="2" ufocc="0" mandatory="yes" idxnum="1,2" idxsnr="103,2" />
<FLD name="UFORM" seqno="5" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="3" ufocc="0" mandatory="yes" idxnum="1,2,3" idxsnr="104,3,1" />
<FLD name="U_TLAB" seqno="6" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UVERS" seqno="7" type="S" level="2" pack="0" scale="0" length="12"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UDESCR" seqno="8" type="S" level="2" pack="0" scale="0" length="25"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_DTYP" seqno="9" type="S" level="2" pack="0" scale="0" length="2"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_INDB" seqno="10" type="S" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TPLLAY" seqno="11" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="0" ufocc="0" />
<FLD name="LAYOUTMOD" seqno="12" type="S" level="2" pack="0" scale="0" length="128"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TPLSYN" seqno="13" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="0" ufocc="0" />
<FLD name="SYNTAXMOD" seqno="14" type="S" level="2" pack="0" scale="0" length="192"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TPLINTF" seqno="15" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="0" ufocc="0" />
<FLD name="INTERFACEMOD" seqno="16" type="S" level="2" pack="0" scale="0" length="64"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TABSTOP" seqno="17" type="N" level="2" pack="10" scale="0" length="2"
 pointer="0" inum="0" ufocc="0" />
<FLD name="WIDGETTYPE" seqno="18" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="0" ufocc="0" />
<FLD name="TEMPLATENAME" seqno="19" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UINHERIT" seqno="20" type="B" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="STARTMOD" seqno="21" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C1,0,0,0,,0,0,0,," />
<FLD name="ENDMOD" seqno="22" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C2,0,0,0,,0,0,0,," />
<FLD name="NEXTFLD" seqno="23" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C3,0,0,0,,0,0,0,," />
<FLD name="PREVFLD" seqno="24" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C4,0,0,0,,0,0,0,," />
<FLD name="ENCRYPT" seqno="25" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C5,0,0,0,,0,0,0,," />
<FLD name="DECRYPT" seqno="26" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C6,0,0,0,,0,0,0,," />
<FLD name="DOC" seqno="27" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C7,0,0,0,,0,0,0,," />
<FLD name="DETAIL" seqno="28" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C8,0,0,0,,0,0,0,," />
<FLD name="MENU" seqno="29" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C9,0,0,0,,0,0,0,," />
<FLD name="ERROR" seqno="30" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CA,0,0,0,,0,0,0,," />
<FLD name="UFORMAT" seqno="31" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CB,0,0,0,,0,0,0,," />
<FLD name="DEFORMAT" seqno="32" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CC,0,0,0,,0,0,0,," />
<FLD name="GENERAL" seqno="33" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CD,0,0,0,,0,0,0,," />
<FLD name="GETFOCUS" seqno="34" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CE,0,0,0,,0,0,0,," />
<FLD name="VCHANGED" seqno="35" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\CF,0,0,0,,0,0,0,," />
<FLD name="WIDGETCREATE" seqno="36" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DD,0,0,0,,0,0,0,," />
<FLD name="VALLAB" seqno="37" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DE,0,0,0,,0,0,0,," />
<FLD name="INITVALUE" seqno="38" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DF,0,0,0,,0,0,0,," />
<FLD name="TPLACTUAL" seqno="39" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E6,0,0,0,,0,0,0,," />
<FLD name="VLDF" seqno="40" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D0,0,0,0,,0,0,0,," />
<FLD name="UPOPUP" seqno="41" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D1,0,0,0,,0,0,0,," />
<FLD name="UISOBJID" seqno="42" type="B" level="2" pack="0" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="HTML_FLDPROP" seqno="43" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D3,0,0,0,,0,0,0,," />
<FLD name="HTML_CTRLTYPE" seqno="44" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D4,0,0,0,,0,0,0,," />
<FLD name="HTML_HOOK_B" seqno="45" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D5,0,0,0,,0,0,0,," />
<FLD name="HTML_HOOK_M" seqno="46" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D6,0,0,0,,0,0,0,," />
<FLD name="HTML_HOOK_E" seqno="47" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D7,0,0,0,,0,0,0,," />
<FLD name="HTML_LBLHK_B" seqno="48" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D8,0,0,0,,0,0,0,," />
<FLD name="HTML_LBLHK_E" seqno="49" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\D9,0,0,0,,0,0,0,," />
<FLD name="HTML_FLDCLASS" seqno="50" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DA,0,0,0,,0,0,0,," />
<FLD name="HTML_LBLCLASS" seqno="51" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DB,0,0,0,,0,0,0,," />
<FLD name="UFOPERS" seqno="52" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\DC,0,0,0,,0,0,0,," />
<FLD name="UFTRIGGERS" seqno="53" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E0,0,0,0,,0,0,0,," />
<FLD name="UGEOMETRY" seqno="54" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E1,0,0,0,,0,0,0,," />
<FLD name="USCOPE" seqno="55" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E2,0,0,0,,0,0,0,," />
<FLD name="UFORMATS" seqno="56" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E3,0,0,0,,0,0,0,," />
<FLD name="UHINTERFACE" seqno="57" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E4,0,0,0,,0,0,0,," />
<FLD name="WEBWIDGETTYPE" seqno="58" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E5,0,0,0,,0,0,0,," />
<FLD name="WEBWIDGETCREATE" seqno="59" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\E6,0,0,0,,0,0,0,," />
</DSC>
<OCC>
<DAT name="UTIMESTAMP">2005-11-24T15:51:32.00</DAT>
<DAT name="ULABEL">ALLMAILFOLTITLE</DAT>
<DAT name="GRP">DUMMY</DAT>
<DAT name="UBASE">DUMMY</DAT>
<DAT name="UFORM">UOMENUMAIL</DAT>
<DAT name="U_DTYP">S</DAT>
<DAT name="U_INDB">B</DAT>
<DAT name="LAYOUTMOD">LFT</DAT>
<DAT name="INTERFACEMOD">C1</DAT>
<DAT name="WIDGETTYPE">COMMANDBUTTON</DAT>
<DAT name="UINHERIT">F</DAT>
<DAT name="WIDGETCREATE" xml:space='preserve'>HALIGN=LEFT&uSEP;VALIGN=CENTER&uSEP;REPRESENTATION=HEADER&uSEP;VSIZE=100&uSEP;ATTACH=LEFT,RIGHT</DAT>
<DAT name="INITVALUE" xml:space='preserve'>All Mail Folders</DAT>
<DAT name="UISOBJID">F</DAT>
<DAT name="HTML_CTRLTYPE">U_BUTTON</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2011-11-23T12:37:22.00</DAT>
<DAT name="ULABEL">ALLMAILTREE</DAT>
<DAT name="GRP">DUMMY</DAT>
<DAT name="UBASE">DUMMY</DAT>
<DAT name="UFORM">UOMENUMAIL</DAT>
<DAT name="U_DTYP">S</DAT>
<DAT name="U_INDB">N</DAT>
<DAT name="INTERFACEMOD">C*</DAT>
<DAT name="WIDGETTYPE">TREE</DAT>
<DAT name="UINHERIT">F</DAT>
<DAT name="WIDGETCREATE" xml:space='preserve'>HASROOTLINES=T&uSEP;HASLINES=T&uSEP;HASBUTTONS=T&uSEP;LISTONLY=F&uSEP;LISTVIEW=N&uSEP;ITEMVALUE=id&uSEP;TYPE1=NMAILBOX&uSEP;NODE1=T&uSEP;NORMAL1=^U_MT_MAILBOX&uSEP;OPEN1=^U_MT_MAILBOX&uSEP;SELECTED1=^U_MT_MAILBOX&uSEP;OPENSELECT1=^U_MT_MAILBOX&uSEP;TYPE2=NSENT&uSEP;NODE2=T&uSEP;NORMAL2=^U_MT_SENT&uSEP;OPEN2=^U_MT_SENT&uSEP;SELECTED2=^U_MT_SENT&uSEP;OPENSELECT2=^U_MT_SENT&uSEP;TYPE3=NOUTBOX&uSEP;NODE3=T&uSEP;NORMAL3=^U_MT_OUTBOX&uSEP;OPEN3=^U_MT_OUTBOX&uSEP;SELECTED3=^U_MT_OUTBOX&uSEP;OPENSELECT3=^U_MT_OUTBOX
&uBS;&uSEP;TYPE4=NJUNK&uSEP;NODE4=T&uSEP;NORMAL4=^U_MT_JUNK&uSEP;OPEN4=^U_MT_JUNK&uSEP;SELECTED4=^U_MT_JUNK&uSEP;OPENSELECT4=^U_MT_JUNK&uSEP;TYPE5=NINBOX&uSEP;NODE5=T&uSEP;NORMAL5=^U_MT_INBOX&uSEP;OPEN5=^U_MT_INBOX&uSEP;SELECTED5=^U_MT_INBOX&uSEP;OPENSELECT5=^U_MT_INBOX&uSEP;TYPE6=NDRAFTS&uSEP;NODE6=T&uSEP;NORMAL6=^U_MT_DRAFTS&uSEP;OPEN6=^U_MT_DRAFTS&uSEP;SELECTED6=^U_MT_DRAFTS&uSEP;OPENSELECT6=^U_MT_DRAFTS&uSEP;TYPE7=NDELETED&uSEP;NODE7=T&uSEP;NORMAL7=^U_MT_DELETED&uSEP;OPEN7=^U_MT_DELETED&uSEP;SELECTED7=^U_MT_D
&uBS;ELETED&uSEP;OPENSELECT7=^U_MT_DELETED&uSEP;TYPE8=NFOLDER&uSEP;NODE8=T&uSEP;NORMAL8=^U_MT_FOLDER&uSEP;OPEN8=^U_MT_FOLDER&uSEP;SELECTED8=^U_MT_FOLDER&uSEP;OPENSELECT8=^U_MT_FOLDER&uSEP;ATTACH=BOTTOM,LEFT,RIGHT&uSEP;LISTMULTISELECT=T</DAT>
<DAT name="VALLAB" xml:space='preserve'>MAILBOX=&uNOT;&uSEP;NMAILBOX&uNOT;&uSEP;Mailbox - Dalibor Ninkovic&uSEP;AREPLY=MAILBOX&uNOT;&uSEP;NFOLDER&uNOT;&uSEP;Awaiting Reply&uSEP;DELETED=MAILBOX&uNOT;&uSEP;NDELETED&uNOT;&uSEP;Deleted Items&uSEP;DRAFTS=MAILBOX&uNOT;&uSEP;NDRAFTS&uNOT;&uSEP;Drafts&uSEP;INBOX=MAILBOX&uNOT;&uSEP;NINBOX&uNOT;&uSEP;Inbox&uSEP;JUNK=MAILBOX&uNOT;&uSEP;NJUNK&uNOT;&uSEP;Junk E-mail&uSEP;OUTBOX=MAILBOX&uNOT;&uSEP;NOUTBOX&uNOT;&uSEP;Outbox&uSEP;SENT=MAILBOX&uNOT;&uSEP;NSENT&uNOT;&uSEP;Sent Items</DAT>
<DAT name="UISOBJID">F</DAT>
<DAT name="HTML_CTRLTYPE">U_INPUT</DAT>
<DAT name="UFTRIGGERS" xml:space='preserve'>; -- start triggers for tree widget 

trigger Expand
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger Expand

trigger Collapse
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger Collapse

trigger Open
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger Open

trigger Close
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger Close

trigger doubleClick
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger doubleClick

trigger columnSorted
params
  numeric columnId: in
  string sortingOrder: in ; ASC | DESC
endparams

end ; trigger columnSorted

trigger columnWidth
params
  numeric id: in
  numeric width: in
endparams

end ; trigger columnWidth

trigger representationChanged ; Only works if tree widget property INLINEEDIT=TRUE
params
  string itemValue: in
  string control: in ; TREE | LIST
  string newRepresentation: in
endparams
variables
  string treeItem, listUpdate
endvariables

  getitem/id treeItem, $fieldvalrep, itemValue
  putitem treeItem, 3, newRepresentation       ; Change representation
  listUpdate = "0="                            ; Indicate partial valrep update
  putitem/id listUpdate, itemValue, treeItem
  $fieldvalrep = listUpdate

end ; trigger representationChanged

; start drag &amp; drop triggers for tree widget

trigger moveTo
params
  string dragvalue: in
  string dropformat: in
  string itemvalue: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger moveTo

trigger moveFrom
params
  string dragvalue: in
  string dropformat: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger moveFrom

trigger moveWithin
params
  string dragvalue: in
  string dropformat: in
  string itemvalue: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger moveWithin

trigger copyTo
params
  string dragvalue: in
  string dropformat: in
  string itemvalue: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger copyTo

trigger createShortcutTo
params
  string dragvalue: in
  string dropformat: in
  string itemvalue: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger createShortcutTo

; -- end triggers for tree widget
</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-11-24T15:51:26.00</DAT>
<DAT name="ULABEL">FAVFOLTITLE</DAT>
<DAT name="GRP">DUMMY</DAT>
<DAT name="UBASE">DUMMY</DAT>
<DAT name="UFORM">UOMENUMAIL</DAT>
<DAT name="U_DTYP">S</DAT>
<DAT name="U_INDB">B</DAT>
<DAT name="INTERFACEMOD">C1</DAT>
<DAT name="WIDGETTYPE">COMMANDBUTTON</DAT>
<DAT name="UINHERIT">F</DAT>
<DAT name="WIDGETCREATE" xml:space='preserve'>HALIGN=LEFT&uSEP;VALIGN=CENTER&uSEP;REPRESENTATION=HEADER&uSEP;VSIZE=100&uSEP;ATTACH=LEFT,RIGHT</DAT>
<DAT name="INITVALUE" xml:space='preserve'>Favourite Folders</DAT>
<DAT name="UISOBJID">F</DAT>
<DAT name="HTML_CTRLTYPE">U_BUTTON</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2011-11-23T12:37:22.00</DAT>
<DAT name="ULABEL">FAVFOLTREE</DAT>
<DAT name="GRP">DUMMY</DAT>
<DAT name="UBASE">DUMMY</DAT>
<DAT name="UFORM">UOMENUMAIL</DAT>
<DAT name="U_DTYP">S</DAT>
<DAT name="U_INDB">N</DAT>
<DAT name="INTERFACEMOD">C*</DAT>
<DAT name="WIDGETTYPE">TREE</DAT>
<DAT name="UINHERIT">F</DAT>
<DAT name="WIDGETCREATE" xml:space='preserve'>HASROOTLINES=F&uSEP;HASLINES=F&uSEP;HASBUTTONS=F&uSEP;LISTONLY=F&uSEP;LISTVIEW=N&uSEP;SORTHEADER=F&uSEP;TYPE1=NODE2&uSEP;NODE1=T&uSEP;NORMAL1=^U_FF_SENT&uSEP;OPEN1=^U_FF_SENT&uSEP;SELECTED1=^U_FF_SENT&uSEP;OPENSELECT1=^U_FF_SENT&uSEP;TYPE2=NODE1&uSEP;NODE2=T&uSEP;NORMAL2=^U_FF_INBOX&uSEP;OPEN2=^U_FF_INBOX&uSEP;SELECTED2=^U_FF_INBOX&uSEP;OPENSELECT2=^U_FF_INBOX&uSEP;TYPE3=NODE3&uSEP;NODE3=T&uSEP;NORMAL3=^U_FF_ZOOM&uSEP;OPEN3=^U_FF_ZOOM&uSEP;SELECTED3=^U_FF_ZOOM&uSEP;OPENSELECT3=^U_FF_ZOOM&uSEP;ATTACH=LEFT,RIG
&uBS;HT&uSEP;LISTMULTISELECT=T</DAT>
<DAT name="VALLAB" xml:space='preserve'>1=&uNOT;&uSEP;NODE1&uNOT;&uSEP;Inbox&uSEP;2=&uNOT;&uSEP;NODE3&uNOT;&uSEP;Unread Mail&uSEP;3=&uNOT;&uSEP;NODE3&uNOT;&uSEP;For Follow Up&uSEP;4=&uNOT;&uSEP;NODE2&uNOT;&uSEP;Sent Mail</DAT>
<DAT name="UISOBJID">F</DAT>
<DAT name="HTML_CTRLTYPE">U_INPUT</DAT>
<DAT name="UFTRIGGERS" xml:space='preserve'>; -- start triggers for tree widget 

trigger Expand
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger Expand

trigger Collapse
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger Collapse

trigger Open
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger Open

trigger Close
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger Close

trigger doubleClick
params
  string control: in ; TREE | LIST | KEYBOARD
  string item: in
endparams

end ; trigger doubleClick

trigger columnSorted
params
  numeric columnId: in
  string sortingOrder: in ; ASC | DESC
endparams

end ; trigger columnSorted

trigger columnWidth
params
  numeric id: in
  numeric width: in
endparams

end ; trigger columnWidth

trigger representationChanged ; Only works if tree widget property INLINEEDIT=TRUE
params
  string itemValue: in
  string control: in ; TREE | LIST
  string newRepresentation: in
endparams
variables
  string treeItem, listUpdate
endvariables

  getitem/id treeItem, $fieldvalrep, itemValue
  putitem treeItem, 3, newRepresentation       ; Change representation
  listUpdate = "0="                            ; Indicate partial valrep update
  putitem/id listUpdate, itemValue, treeItem
  $fieldvalrep = listUpdate

end ; trigger representationChanged

; start drag &amp; drop triggers for tree widget

trigger moveTo
params
  string dragvalue: in
  string dropformat: in
  string itemvalue: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger moveTo

trigger moveFrom
params
  string dragvalue: in
  string dropformat: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger moveFrom

trigger moveWithin
params
  string dragvalue: in
  string dropformat: in
  string itemvalue: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger moveWithin

trigger copyTo
params
  string dragvalue: in
  string dropformat: in
  string itemvalue: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger copyTo

trigger createShortcutTo
params
  string dragvalue: in
  string dropformat: in
  string itemvalue: in
  numeric numberofobjects: in
  numeric index: in
endparams

end ; trigger createShortcutTo

; -- end triggers for tree widget
</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2011-11-23T12:37:22.00</DAT>
<DAT name="ULABEL">MTITLE</DAT>
<DAT name="GRP">DUMMY</DAT>
<DAT name="UBASE">DUMMY</DAT>
<DAT name="UFORM">UOMENUMAIL</DAT>
<DAT name="U_DTYP">S</DAT>
<DAT name="U_INDB">N</DAT>
<DAT name="LAYOUTMOD">LFT</DAT>
<DAT name="SYNTAXMOD">MUL</DAT>
<DAT name="INTERFACEMOD">C20</DAT>
<DAT name="WIDGETTYPE">NOEDITBOX</DAT>
<DAT name="UINHERIT">F</DAT>
<DAT name="WIDGETCREATE" xml:space='preserve'>FONT=SANSHUGE&uSEP;FRAME=F&uSEP;3D=F&uSEP;ATTACH=TOP,LEFT,RIGHT</DAT>
<DAT name="INITVALUE" xml:space='preserve'> Mail</DAT>
<DAT name="UISOBJID">F</DAT>
<DAT name="HTML_CTRLTYPE">U_INPUT</DAT>
</OCC>
</TABLE>
<TABLE>
<DSC name="UXREGS" model="DICT" system="S" pseudo ="73" level="1" noupdate="0"
 rbk="0" ffsql="0" transnr="0" segsize="0" ufocc="0" charset=".U">
<FLD name="UTIMESTAMP" seqno="1" type="E" level="2" pack="0" scale="0" length="15"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_STAT" seqno="2" type="S" level="2" pack="0" scale="0" length="4"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_TYPE" seqno="3" type="S" level="2" pack="0" scale="0" length="2"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_FORMLIB" seqno="4" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="2" ufocc="0" mandatory="yes" idxnum="1,3" idxsnr="101,1" />
<FLD name="U_NAME" seqno="5" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="2" ufocc="0" mandatory="yes" idxnum="1,2" idxsnr="102,1" />
<FLD name="UVERS" seqno="6" type="S" level="2" pack="0" scale="0" length="12"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UDESCR" seqno="7" type="S" level="2" pack="0" scale="0" length="25"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_DTYP" seqno="8" type="S" level="2" pack="0" scale="0" length="2"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_LAYOUT" seqno="9" type="S" level="2" pack="0" scale="0" length="46"
 pointer="0" inum="0" ufocc="0" />
<FLD name="U_DOC" seqno="10" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C1,0,0,0,,0,0,0,," />
<FLD name="USCOPE" seqno="11" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C2,0,0,0,,0,0,0,," />
<FLD name="UHINTERFACE" seqno="12" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C3,0,0,0,,0,0,0,," />
</DSC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-05T15:51:16.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_CONCODE</DAT>
<DAT name="U_DTYP">N</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-08T14:16:16.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_EMAIL</DAT>
<DAT name="U_DTYP">S</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-05T13:04:27.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_MAILSERVER</DAT>
<DAT name="U_DTYP">S</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-14T16:44:04.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_OUTBOX_NUM</DAT>
<DAT name="U_DTYP">N</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-08T13:51:15.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_POP3</DAT>
<DAT name="U_DTYP">S</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-08T13:51:15.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_PWD</DAT>
<DAT name="U_DTYP">S</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-08T13:51:15.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_SMTP</DAT>
<DAT name="U_DTYP">S</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-08T13:41:31.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_TIMERHANDLE</DAT>
<DAT name="U_DTYP">H</DAT>
<DAT name="USCOPE">PAR</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-03T01:25:25.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_UOUTLOOKID</DAT>
<DAT name="U_DTYP">S</DAT>
</OCC>
<OCC>
<DAT name="UTIMESTAMP">2005-12-08T13:51:15.00</DAT>
<DAT name="U_FORMLIB">UOMENUMAIL</DAT>
<DAT name="U_NAME">CV_USER</DAT>
<DAT name="U_DTYP">S</DAT>
</OCC>
</TABLE>
</UNIFACE>
